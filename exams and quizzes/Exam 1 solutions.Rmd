---
title: "Exam 1 Solutions"
author: "Your name"
date: "2024-09-30"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Exam 1

```{r preamble}
library(tidyverse)
```

### 1. (5 points) Load the data called dat.nsduh.small.csv. Take a look at the data.

```{r load-data}
dat <- read_csv("dat.nsduh.small.csv")
```
Answer:


### 2. (5 points) Read the codebook. What do these variables represent: mjage, iralcage, sexatract, speakengl, and irsex?

Answer: 


### 3. (5 points) What type of stat variables are the variables from #2?

```{r var-types}
dat$mjage
dat$iralcage
dat$sexatract
dat$speakengl
dat$irsex
```

Answer: 

mjage: Quantitative

iralcage: Quantitative

sexatract: Categorical

speakengl: Categorical

irsex: Categorical



### 4. (5 points) Do visual EDA for mjage and iralcage, separately. (Hint: To compare the plots, make the axes limits, x and y, be the same for both plots. Also, try out different numbers of bins to see how they change.)

```{r visual-EDA-quantitative}
#tidyverse version
dat %>% ggplot(aes(mjage)) + geom_histogram() + xlim(0,40) + ylim(0,50)
dat %>% ggplot(aes(iralcage)) + geom_histogram() + xlim(0,40) + ylim(0,50)

# base R version
hist(dat$mjage, breaks = 20, xlim=c(0,30))
hist(dat$iralcage, breaks = 20, xlim=c(0,30))

```
Answer: 

mjage: Unimodal, symmetric, longer right tail, no clear outliers.

iralcage: Bimodal, symmetric, longer left tail, no clear outliers.


### 5. (5 points) Compare the two plots. How are they different and how are they similar? What theory do you have to explain these differences?

Answer: They're similar, but iralcage is bimodal (perhaps some people try alcohol for the first time in high school and some try it in college) and has a longer left tail, meaning that people start using alcohol when they are younger, rather than older. For marijuana, there is a longer right tail, which means that some people start using when they are older. 


### 6. (5 points) Do visual EDA for irsex and sexatract. What do you learn from this?

```{r visual-EDA-categorical}

# this code makes the levels of the factors take on the values from the codebook:
dat <- dat %>% 
  mutate_at(c('irsex', 'sexatract', 'speakengl'), as.factor) %>%
  mutate(irsex = recode(irsex,         "1"="Male", "2"="Female"),
         sexatract = recode(sexatract, "1"="I am only attracted to opposite sex",
                                       "2"="I am mostly attracted to opposite sex",
                                       "3"="I am equally attracted to males and females",
                                       "4"="I am mostly attracted to same sex",
                                       "5"="I am only attracted to same sex",
                                       "6"="I am not sure",
                                       "99"="Legitimate skip"),
         speakengl = recode(speakengl, "1"="Very well",
                                       "2"="Well",
                                       "3"="Not well",
                                       "4"="Not at all"))

dat %>% 
  ggplot(aes(irsex)) + 
  geom_bar() + 
  xlab("Sex") + 
  ylab("Count") + 
  ggtitle("Visual EDA for irsex")

dat %>%  
  ggplot(aes(sexatract)) + 
  geom_bar() + 
  theme(axis.text.x = element_text(angle=90, vjust=.5, hjust=1)) + 
  xlab("Sexual attraction") + 
  ylab("Count") + 
  ggtitle("Visual EDA for sexatract")

dat %>% ggplot(aes(speakengl)) + geom_bar() + xlab("Speak English") + ylab("Count") + ggtitle("Visual EDA for speakengl")

```

Answer: There are more men than women in this sample, most people report only being attracted to the opposite sex, most people speak English very well.



### 7. (5 points) Do quantitative EDA for irsex, sexatract, and speakengl. What do you learn from this that you didn't know from the visual EDA?

```{r quantitative-EDA-categorical}

dat %>%
  count(irsex)%>%
  mutate(prop = prop.table(n))

dat %>%
  count(sexatract)%>%
  mutate(prop = prop.table(n))

dat %>%
  count(speakengl)%>%
  mutate(prop = prop.table(n))


```

Answer: The small numbers of the lower four categories.



### 8. (5 points) Copy your line from the visual EDA for mjage. What happens when you use this code "aes(x=mjage, fill=sexatract)" for the aesethetics in ggplot? Do you find out something interesting?

```{r adding-fill}
dat %>% ggplot(aes(x=mjage, fill=sexatract)) + geom_histogram() + xlim(0,40) + ylim(0,50)
```
Answer: It looks like the individuals who are not just attracted to the opposite sex try marijuana at younger ages compared to those who are attracted only to the opposite sex.



